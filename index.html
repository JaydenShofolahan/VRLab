<html>

<head>
  <meta charset="utf-8">
  <title>Hello, World! • A-Frame</title>
  <meta name="description" content="Hello, World! • A-Frame">
  <script
    src="https://cdn.jsdelivr.net/gh/aframevr/aframe@bd6bf821eda2522f84a1dc2b6d78674dfcd06e4a/dist/aframe-master.min.js"></script>
</head>

<body>
  <script>
    AFRAME.registerComponent('lightning', {
      schema: {
        duration: { type: 'int', default: 399 }
      },
      init: function () {
            var entity = document.getElementById('thunder');

        this.el.setAttribute('animation', {
          property: 'light.intensity',
          to: 1,
          from: 0,
          dur: this.data.duration,
          dir: 'alternate',
          loop: false,
          startEvents: "lightning"
        });
        this.el.emit(`lightning`, null, false);
        this.el.addEventListener('animationcomplete', (event) => {
           //entity.components.sound.stopSound()
          setTimeout(()=> entity.components.sound.playSound(),500);
          console.log('Animation on entity complete!', event.detail.name);
          // Perform actions after the animation ends, e.g.,
          this.data.duration = Math.random() * 1999
          this.el.setAttribute('animation', {
            property: 'light.intensity',
            to: 0,
            from: 1,
            dur: this.data.duration,
            dir: 'alternate',
            loop: false,
            startEvents: "lightning"
          });
          this.el.emit(`lightning`, null, false);
      

          // setTimeout(()=>   ,Math.random()*6000)

          // entity.setAttribute('material', 'color', 'red');
        });

        // console.log(this.data.message); // Access schema data
        // this.el.setAttribute('material', 'color', this.data.color); // Manipulate entity
      },
      update: function () {

        //
        // Logic to run when properties change
      },
      tick: function () {

        // const box = document.querySelector('a-box');

        // console.log(this.el.animation)  
      }
    });
  </script>
  <a-scene obb-collider="showColliders: false" background="color: #000000">
      <a-sound id="thunder" src="src: url(Thunder.aac)" autoplay="false" position="0 2 5"></a-sound>
     
    <!-- <a-entity light="type: ambient; color: #BBB"></a-entity> -->
   

    <!-- <a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9" shadow></a-box>
      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E" shadow></a-sphere>
      <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D" shadow></a-cylinder>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4" shadow></a-plane> -->
    <a-assets>
      <a-asset-item id="room" src="Untitled.glb"></a-asset-item>
    </a-assets>
   
    <a-entity rotation="0 180 0" position="-15.690353096534456 0 -26.73773478303973">
       <a-box position="-41 0 0"> <a-entity lightning nimation="property: light.intensity;
 from: 0 ; to: 1; dur: 15; loop:true; easings: easeInOutSine; dir: alternate;
  autoplay: true; startEvents: lightning;" light="type: directional; 
  color: #FFF; intensity: 1.0" position="-5.690353096534456 0 -26.73773478303973"></a-entity></a-box>
      <a-entity obb-collider wasd-controls look-controls camera id="camera"></a-entity></a-entity>
    <!-- <a-entity light="type: directional;" animation="property: light.insensity; from: 1.0; to: 0; dur: 1000; loop:true; easings: easeInOutSine; dir: alternate; autoplay: true"></a-entity> -->
    <a-entity obb-collider position="0 -10 -20" gltf-model="#room"> </a-entity>
    <!-- <a-entity animation="property: light.intensity; from: 0 ; to: 10; dur: 1500; loop:true; easings: easeInOutSine; dir: alternate; autoplay: true" light="color: #AFA; intensity: 1.5" position="-1 -2000 0"></a-entity> -->
  
    <!-- <a-plane width="4" height="4" animation="property: light.color; from:rgb(200, 70, 30); to:rgb(0, 30, 180); dur: 1500; loop:true; easings: easeInOutSine; dir: alternate; autoplay: true"></a-plane> -->
  </a-scene>
</body>

</html>